spec:
  alerts:
    - rule: DEPLOYMENT_FAILED
    - rule: DOMAIN_FAILED
  features:
    - buildpack-stack=ubuntu-22
  ingress:
    rules:
      - component:
          name: api
        match:
          path:
            prefix: /
      - component:
          name: ui
        match:
          path:
            prefix: /ui
  name: mem0-mcp
  region: fra1
  services:
    - name: api
      environment_slug: python
      github:
        branch: main
        repo: Sternberg-Corp-Projects/mem0
      dockerfile_path: openmemory/api/Dockerfile
      http_port: 8765
      instance_count: 1
      instance_size_slug: basic-xxs
      envs:
        - key: OPENAI_API_KEY
          scope: RUN_TIME
          type: SECRET
          value: "your_openai_api_key_here"
        - key: DATABASE_URL
          scope: RUN_TIME
          value: ${db.DATABASE_URL}
        - key: NEXT_PUBLIC_BASE_URL
          scope: RUN_AND_BUILD_TIME
          value: ${APP_URL}
        - key: QDRANT_URL
          scope: RUN_TIME
          type: SECRET
          value: "https://YOUR_QDRANT_URL:6333"
        - key: QDRANT_API_KEY
          scope: RUN_TIME
          type: SECRET
          value: "your_qdrant_api_key_here"
      health_check:
        http_path: /docs
    - name: ui
      environment_slug: node-js
      github:
        branch: main
        repo: Sternberg-Corp-Projects/mem0
      dockerfile_path: openmemory/ui/Dockerfile
      http_port: 3000
      instance_count: 1
      instance_size_slug: basic-xxs
      envs:
        - key: NEXT_PUBLIC_API_URL
          scope: RUN_TIME
          value: ${api.PUBLIC_URL}
        - key: NEXT_PUBLIC_USER_ID
          scope: RUN_TIME
          value: sternberg_dev
        - key: NEXT_PUBLIC_BASE_URL
          scope: RUN_AND_BUILD_TIME
          value: ${APP_URL}
  databases:
    - name: db
      engine: PG
      version: "16"
      production: true
